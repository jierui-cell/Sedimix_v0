Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job stats:
job                                   count
----------------------------------  -------
all                                       1
bam_to_fastq                              1
classification                            1
generate_classified_reads                 1
map_after_classification                  1
map_sort_index                            1
mapping_quality_filter                    1
run_mapdamage                             1
run_mapdamage_after_classification        1
total                                     9

Select jobs to execute...

[Mon Apr  8 09:59:36 2024]
rule map_sort_index:
    input: data/stripped_simulation_s.fq.gz
    output: mapping/stripped_simulation_s.bam, mapping/stripped_simulation_s.bam.bai, temp/stripped_simulation_s.sai, temp/stripped_simulation_s.sam
    jobid: 5
    benchmark: benchmarks/map_sort_index/stripped_simulation_s.txt
    reason: Missing output files: mapping/stripped_simulation_s.bam
    wildcards: sample=stripped_simulation_s
    resources: tmpdir=/tmp

[Mon Apr  8 10:13:28 2024]
Finished job 5.
1 of 9 steps (11%) done
Select jobs to execute...

[Mon Apr  8 10:13:28 2024]
rule mapping_quality_filter:
    input: mapping/stripped_simulation_s.bam
    output: mapping/stripped_simulation_s_L30MQ25.bam
    jobid: 4
    benchmark: benchmarks/mapping_quality_filter/stripped_simulation_s.txt
    reason: Missing output files: mapping/stripped_simulation_s_L30MQ25.bam; Input files updated by another job: mapping/stripped_simulation_s.bam
    wildcards: sample=stripped_simulation_s
    resources: tmpdir=/tmp

[Mon Apr  8 10:13:46 2024]
Finished job 4.
2 of 9 steps (22%) done
Select jobs to execute...

[Mon Apr  8 10:13:46 2024]
rule run_mapdamage:
    input: mapping/stripped_simulation_s_L30MQ25.bam, /global/home/users/jieruixu/jieruixu/sediment_dna/sedimix/reference_data/human/hg19.fa
    output: mapdamage_result/stripped_simulation_s
    jobid: 6
    benchmark: benchmarks/mapdamage/stripped_simulation_s.txt
    reason: Missing output files: mapdamage_result/stripped_simulation_s; Input files updated by another job: mapping/stripped_simulation_s_L30MQ25.bam
    wildcards: sample=stripped_simulation_s
    resources: tmpdir=/tmp

[Mon Apr  8 10:21:56 2024]
Finished job 6.
3 of 9 steps (33%) done
Select jobs to execute...

[Mon Apr  8 10:21:56 2024]
rule bam_to_fastq:
    input: mapping/stripped_simulation_s_L30MQ25.bam
    output: mapping/stripped_simulation_s_L30MQ25.fq
    jobid: 3
    benchmark: benchmarks/bam_to_fastq/stripped_simulation_s.txt
    reason: Missing output files: mapping/stripped_simulation_s_L30MQ25.fq; Input files updated by another job: mapping/stripped_simulation_s_L30MQ25.bam
    wildcards: sample=stripped_simulation_s
    resources: tmpdir=/tmp

[Mon Apr  8 10:21:57 2024]
Finished job 3.
4 of 9 steps (44%) done
Select jobs to execute...

[Mon Apr  8 10:21:57 2024]
rule classification:
    input: mapping/stripped_simulation_s_L30MQ25.fq
    output: classification/stripped_simulation_s_L30MQ25.centrifuge, classification/stripped_simulation_s_L30MQ25.centrifugeLog, classification/stripped_simulation_s_L30MQ25.k2report
    jobid: 2
    benchmark: benchmarks/classification/stripped_simulation_s.txt
    reason: Missing output files: classification/stripped_simulation_s_L30MQ25.centrifuge; Input files updated by another job: mapping/stripped_simulation_s_L30MQ25.fq
    wildcards: sample=stripped_simulation_s
    resources: tmpdir=/tmp

[Mon Apr  8 10:22:30 2024]
Finished job 2.
5 of 9 steps (56%) done
Select jobs to execute...

[Mon Apr  8 10:22:30 2024]
rule generate_classified_reads:
    input: classification/stripped_simulation_s_L30MQ25.centrifuge, mapping/stripped_simulation_s_L30MQ25.fq
    output: final_reads/stripped_simulation_s_classified_homo_sapiens.fq, final_reads/stripped_simulation_s_reads.lst
    jobid: 1
    benchmark: benchmarks/generate_classified_reads/stripped_simulation_s.txt
    reason: Missing output files: final_reads/stripped_simulation_s_classified_homo_sapiens.fq, final_reads/stripped_simulation_s_reads.lst; Input files updated by another job: classification/stripped_simulation_s_L30MQ25.centrifuge, mapping/stripped_simulation_s_L30MQ25.fq
    wildcards: sample=stripped_simulation_s
    resources: tmpdir=/tmp

[Mon Apr  8 10:22:40 2024]
Finished job 1.
6 of 9 steps (67%) done
Select jobs to execute...

[Mon Apr  8 10:22:40 2024]
rule map_after_classification:
    input: final_reads/stripped_simulation_s_classified_homo_sapiens.fq
    output: mapping/stripped_simulation_s_classified_homo_sapiens.bam, mapping/stripped_simulation_s_classified_homo_sapiens.bam.bai, temp/stripped_simulation_s_classified_homo_sapiens.sai, temp/stripped_simulation_s_classified_homo_sapiens.sam
    jobid: 8
    benchmark: benchmarks/map_after_classification/stripped_simulation_s.txt
    reason: Missing output files: mapping/stripped_simulation_s_classified_homo_sapiens.bam; Input files updated by another job: final_reads/stripped_simulation_s_classified_homo_sapiens.fq
    wildcards: sample=stripped_simulation_s
    resources: tmpdir=/tmp

[Mon Apr  8 10:23:25 2024]
Finished job 8.
7 of 9 steps (78%) done
Select jobs to execute...

[Mon Apr  8 10:23:25 2024]
rule run_mapdamage_after_classification:
    input: mapping/stripped_simulation_s_classified_homo_sapiens.bam, /global/home/users/jieruixu/jieruixu/sediment_dna/sedimix/reference_data/human/hg19.fa
    output: mapdamage_result_after_classification/stripped_simulation_s
    jobid: 7
    benchmark: benchmarks/run_mapdamage_after_classification/stripped_simulation_s.txt
    reason: Missing output files: mapdamage_result_after_classification/stripped_simulation_s; Input files updated by another job: mapping/stripped_simulation_s_classified_homo_sapiens.bam
    wildcards: sample=stripped_simulation_s
    resources: tmpdir=/tmp

[Mon Apr  8 10:31:26 2024]
Finished job 7.
8 of 9 steps (89%) done
Select jobs to execute...

[Mon Apr  8 10:31:26 2024]
localrule all:
    input: final_reads/stripped_simulation_s_classified_homo_sapiens.fq, final_reads/stripped_simulation_s_reads.lst, mapdamage_result/stripped_simulation_s, mapdamage_result_after_classification/stripped_simulation_s
    jobid: 0
    reason: Input files updated by another job: final_reads/stripped_simulation_s_reads.lst, mapdamage_result/stripped_simulation_s, final_reads/stripped_simulation_s_classified_homo_sapiens.fq, mapdamage_result_after_classification/stripped_simulation_s
    resources: tmpdir=/tmp

[Mon Apr  8 10:31:26 2024]
Finished job 0.
9 of 9 steps (100%) done
Complete log: .snakemake/log/2024-04-08T095935.514196.snakemake.log
