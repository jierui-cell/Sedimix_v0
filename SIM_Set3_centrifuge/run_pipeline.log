Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job stats:
job                                   count
----------------------------------  -------
all                                       1
bam_to_fastq                              1
classification                            1
generate_classified_reads                 1
map_after_classification                  1
map_sort_index                            1
mapping_quality_filter                    1
run_mapdamage                             1
run_mapdamage_after_classification        1
total                                     9

Select jobs to execute...

[Mon Apr  8 09:59:36 2024]
rule map_sort_index:
    input: data/stripped_simulation_s.fq.gz
    output: mapping/stripped_simulation_s.bam, mapping/stripped_simulation_s.bam.bai, temp/stripped_simulation_s.sai, temp/stripped_simulation_s.sam
    jobid: 5
    benchmark: benchmarks/map_sort_index/stripped_simulation_s.txt
    reason: Missing output files: mapping/stripped_simulation_s.bam
    wildcards: sample=stripped_simulation_s
    resources: tmpdir=/tmp

[bwa_aln] 17bp reads: max_diff = 2
[bwa_aln] 38bp reads: max_diff = 3
[bwa_aln] 64bp reads: max_diff = 4
[bwa_aln] 93bp reads: max_diff = 5
[bwa_aln] 124bp reads: max_diff = 6
[bwa_aln] 157bp reads: max_diff = 7
[bwa_aln] 190bp reads: max_diff = 8
[bwa_aln] 225bp reads: max_diff = 9
[bwa_aln_core] calculate SA coordinate... 72.97 sec
[bwa_aln_core] write to the disk... 0.04 sec
[bwa_aln_core] 262144 sequences have been processed.
[bwa_aln_core] calculate SA coordinate... 94.05 sec
[bwa_aln_core] write to the disk... 0.02 sec
[bwa_aln_core] 524288 sequences have been processed.
[bwa_aln_core] calculate SA coordinate... 93.35 sec
[bwa_aln_core] write to the disk... 0.02 sec
[bwa_aln_core] 786432 sequences have been processed.
[bwa_aln_core] calculate SA coordinate... 63.03 sec
[bwa_aln_core] write to the disk... 0.02 sec
[bwa_aln_core] 1048576 sequences have been processed.
[bwa_aln_core] calculate SA coordinate... 28.44 sec
[bwa_aln_core] write to the disk... 0.02 sec
[bwa_aln_core] 1310720 sequences have been processed.
[bwa_aln_core] calculate SA coordinate... 29.76 sec
[bwa_aln_core] write to the disk... 0.02 sec
[bwa_aln_core] 1572864 sequences have been processed.
[bwa_aln_core] calculate SA coordinate... 37.62 sec
[bwa_aln_core] write to the disk... 0.01 sec
[bwa_aln_core] 1835008 sequences have been processed.
[bwa_aln_core] calculate SA coordinate... 49.43 sec
[bwa_aln_core] write to the disk... 0.02 sec
[bwa_aln_core] 2097152 sequences have been processed.
[bwa_aln_core] calculate SA coordinate... 103.15 sec
[bwa_aln_core] write to the disk... 0.03 sec
[bwa_aln_core] 2359296 sequences have been processed.
[bwa_aln_core] calculate SA coordinate... 81.26 sec
[bwa_aln_core] write to the disk... 0.02 sec
[bwa_aln_core] 2621440 sequences have been processed.
[bwa_aln_core] calculate SA coordinate... 36.11 sec
[bwa_aln_core] write to the disk... 0.02 sec
[bwa_aln_core] 2883584 sequences have been processed.
[bwa_aln_core] calculate SA coordinate... 29.62 sec
[bwa_aln_core] write to the disk... 0.02 sec
[bwa_aln_core] 3145728 sequences have been processed.
[bwa_aln_core] calculate SA coordinate... 51.73 sec
[bwa_aln_core] write to the disk... 0.03 sec
[bwa_aln_core] 3407872 sequences have been processed.
[bwa_aln_core] calculate SA coordinate... 39.57 sec
[bwa_aln_core] write to the disk... 0.02 sec
[bwa_aln_core] 3670016 sequences have been processed.
[bwa_aln_core] calculate SA coordinate... 30.95 sec
[bwa_aln_core] write to the disk... 0.02 sec
[bwa_aln_core] 3932160 sequences have been processed.
[bwa_aln_core] calculate SA coordinate... 61.23 sec
[bwa_aln_core] write to the disk... 0.02 sec
[bwa_aln_core] 4194304 sequences have been processed.
[bwa_aln_core] calculate SA coordinate... 48.76 sec
[bwa_aln_core] write to the disk... 0.02 sec
[bwa_aln_core] 4456448 sequences have been processed.
[bwa_aln_core] calculate SA coordinate... 37.38 sec
[bwa_aln_core] write to the disk... 0.01 sec
[bwa_aln_core] 4718592 sequences have been processed.
[bwa_aln_core] calculate SA coordinate... 26.74 sec
[bwa_aln_core] write to the disk... 0.01 sec
[bwa_aln_core] 4980736 sequences have been processed.
[bwa_aln_core] calculate SA coordinate... 26.56 sec
[bwa_aln_core] write to the disk... 0.01 sec
[bwa_aln_core] 5242880 sequences have been processed.
[bwa_aln_core] calculate SA coordinate... 28.52 sec
[bwa_aln_core] write to the disk... 0.01 sec
[bwa_aln_core] 5505024 sequences have been processed.
[bwa_aln_core] calculate SA coordinate... 35.82 sec
[bwa_aln_core] write to the disk... 0.02 sec
[bwa_aln_core] 5767168 sequences have been processed.
[bwa_aln_core] calculate SA coordinate... 35.84 sec
[bwa_aln_core] write to the disk... 0.02 sec
[bwa_aln_core] 6029312 sequences have been processed.
[bwa_aln_core] calculate SA coordinate... 45.59 sec
[bwa_aln_core] write to the disk... 0.02 sec
[bwa_aln_core] 6291456 sequences have been processed.
[bwa_aln_core] calculate SA coordinate... 49.57 sec
[bwa_aln_core] write to the disk... 0.01 sec
[bwa_aln_core] 6553600 sequences have been processed.
[bwa_aln_core] calculate SA coordinate... 56.85 sec
[bwa_aln_core] write to the disk... 0.02 sec
[bwa_aln_core] 6815744 sequences have been processed.
[bwa_aln_core] calculate SA coordinate... 96.98 sec
[bwa_aln_core] write to the disk... 0.03 sec
[bwa_aln_core] 7077888 sequences have been processed.
[bwa_aln_core] calculate SA coordinate... 96.78 sec
[bwa_aln_core] write to the disk... 0.03 sec
[bwa_aln_core] 7340032 sequences have been processed.
[bwa_aln_core] calculate SA coordinate... 96.91 sec
[bwa_aln_core] write to the disk... 0.02 sec
[bwa_aln_core] 7602176 sequences have been processed.
[bwa_aln_core] calculate SA coordinate... 96.77 sec
[bwa_aln_core] write to the disk... 0.04 sec
[bwa_aln_core] 7864320 sequences have been processed.
[bwa_aln_core] calculate SA coordinate... 97.14 sec
[bwa_aln_core] write to the disk... 0.03 sec
[bwa_aln_core] 8126464 sequences have been processed.
[bwa_aln_core] calculate SA coordinate... 93.43 sec
[bwa_aln_core] write to the disk... 0.01 sec
[bwa_aln_core] 8388608 sequences have been processed.
[bwa_aln_core] calculate SA coordinate... 93.55 sec
[bwa_aln_core] write to the disk... 0.03 sec
[bwa_aln_core] 8650752 sequences have been processed.
[bwa_aln_core] calculate SA coordinate... 93.11 sec
[bwa_aln_core] write to the disk... 0.03 sec
[bwa_aln_core] 8912896 sequences have been processed.
[bwa_aln_core] calculate SA coordinate... 43.09 sec
[bwa_aln_core] write to the disk... 0.04 sec
[bwa_aln_core] 9175040 sequences have been processed.
[bwa_aln_core] calculate SA coordinate... 18.12 sec
[bwa_aln_core] write to the disk... 0.02 sec
[bwa_aln_core] 9437184 sequences have been processed.
[bwa_aln_core] calculate SA coordinate... 18.13 sec
[bwa_aln_core] write to the disk... 0.06 sec
[bwa_aln_core] 9699328 sequences have been processed.
[bwa_aln_core] calculate SA coordinate... 18.18 sec
[bwa_aln_core] write to the disk... 0.04 sec
[bwa_aln_core] 9961472 sequences have been processed.
[bwa_aln_core] calculate SA coordinate... 2.71 sec
[bwa_aln_core] write to the disk... 0.00 sec
[bwa_aln_core] 10000000 sequences have been processed.
[main] Version: 0.7.17-r1188
[main] CMD: bwa aln -t 8 /global/home/users/jieruixu/jieruixu/sediment_dna/sedimix/reference_data/human/hg19.fa data/stripped_simulation_s.fq.gz
[main] Real time: 560.820 sec; CPU: 2173.361 sec
[bwa_aln_core] convert to sequence coordinate... 2.09 sec
[bwa_aln_core] refine gapped alignments... 0.51 sec
[bwa_aln_core] print alignments... 0.22 sec
[bwa_aln_core] 262144 sequences have been processed.
[bwa_aln_core] convert to sequence coordinate... 1.38 sec
[bwa_aln_core] refine gapped alignments... 0.25 sec
[bwa_aln_core] print alignments... 0.14 sec
[bwa_aln_core] 524288 sequences have been processed.
[bwa_aln_core] convert to sequence coordinate... 1.34 sec
[bwa_aln_core] refine gapped alignments... 0.25 sec
[bwa_aln_core] print alignments... 0.13 sec
[bwa_aln_core] 786432 sequences have been processed.
[bwa_aln_core] convert to sequence coordinate... 1.30 sec
[bwa_aln_core] refine gapped alignments... 0.23 sec
[bwa_aln_core] print alignments... 0.15 sec
[bwa_aln_core] 1048576 sequences have been processed.
[bwa_aln_core] convert to sequence coordinate... 1.24 sec
[bwa_aln_core] refine gapped alignments... 0.22 sec
[bwa_aln_core] print alignments... 0.13 sec
[bwa_aln_core] 1310720 sequences have been processed.
[bwa_aln_core] convert to sequence coordinate... 1.25 sec
[bwa_aln_core] refine gapped alignments... 0.23 sec
[bwa_aln_core] print alignments... 0.12 sec
[bwa_aln_core] 1572864 sequences have been processed.
[bwa_aln_core] convert to sequence coordinate... 1.27 sec
[bwa_aln_core] refine gapped alignments... 0.22 sec
[bwa_aln_core] print alignments... 0.13 sec
[bwa_aln_core] 1835008 sequences have been processed.
[bwa_aln_core] convert to sequence coordinate... 1.27 sec
[bwa_aln_core] refine gapped alignments... 0.24 sec
[bwa_aln_core] print alignments... 0.11 sec
[bwa_aln_core] 2097152 sequences have been processed.
[bwa_aln_core] convert to sequence coordinate... 1.34 sec
[bwa_aln_core] refine gapped alignments... 0.25 sec
[bwa_aln_core] print alignments... 0.13 sec
[bwa_aln_core] 2359296 sequences have been processed.
[bwa_aln_core] convert to sequence coordinate... 1.31 sec
[bwa_aln_core] refine gapped alignments... 0.24 sec
[bwa_aln_core] print alignments... 0.13 sec
[bwa_aln_core] 2621440 sequences have been processed.
[bwa_aln_core] convert to sequence coordinate... 1.25 sec
[bwa_aln_core] refine gapped alignments... 0.22 sec
[bwa_aln_core] print alignments... 0.11 sec
[bwa_aln_core] 2883584 sequences have been processed.
[bwa_aln_core] convert to sequence coordinate... 1.25 sec
[bwa_aln_core] refine gapped alignments... 0.22 sec
[bwa_aln_core] print alignments... 0.12 sec
[bwa_aln_core] 3145728 sequences have been processed.
[bwa_aln_core] convert to sequence coordinate... 1.26 sec
[bwa_aln_core] refine gapped alignments... 0.23 sec
[bwa_aln_core] print alignments... 0.12 sec
[bwa_aln_core] 3407872 sequences have been processed.
[bwa_aln_core] convert to sequence coordinate... 1.25 sec
[bwa_aln_core] refine gapped alignments... 0.23 sec
[bwa_aln_core] print alignments... 0.12 sec
[bwa_aln_core] 3670016 sequences have been processed.
[bwa_aln_core] convert to sequence coordinate... 1.30 sec
[bwa_aln_core] refine gapped alignments... 0.22 sec
[bwa_aln_core] print alignments... 0.11 sec
[bwa_aln_core] 3932160 sequences have been processed.
[bwa_aln_core] convert to sequence coordinate... 1.26 sec
[bwa_aln_core] refine gapped alignments... 0.23 sec
[bwa_aln_core] print alignments... 0.13 sec
[bwa_aln_core] 4194304 sequences have been processed.
[bwa_aln_core] convert to sequence coordinate... 1.27 sec
[bwa_aln_core] refine gapped alignments... 0.22 sec
[bwa_aln_core] print alignments... 0.13 sec
[bwa_aln_core] 4456448 sequences have been processed.
[bwa_aln_core] convert to sequence coordinate... 1.27 sec
[bwa_aln_core] refine gapped alignments... 0.22 sec
[bwa_aln_core] print alignments... 0.12 sec
[bwa_aln_core] 4718592 sequences have been processed.
[bwa_aln_core] convert to sequence coordinate... 1.23 sec
[bwa_aln_core] refine gapped alignments... 0.23 sec
[bwa_aln_core] print alignments... 0.12 sec
[bwa_aln_core] 4980736 sequences have been processed.
[bwa_aln_core] convert to sequence coordinate... 1.24 sec
[bwa_aln_core] refine gapped alignments... 0.22 sec
[bwa_aln_core] print alignments... 0.11 sec
[bwa_aln_core] 5242880 sequences have been processed.
[bwa_aln_core] convert to sequence coordinate... 1.24 sec
[bwa_aln_core] refine gapped alignments... 0.22 sec
[bwa_aln_core] print alignments... 0.11 sec
[bwa_aln_core] 5505024 sequences have been processed.
[bwa_aln_core] convert to sequence coordinate... 1.25 sec
[bwa_aln_core] refine gapped alignments... 0.22 sec
[bwa_aln_core] print alignments... 0.12 sec
[bwa_aln_core] 5767168 sequences have been processed.
[bwa_aln_core] convert to sequence coordinate... 1.24 sec
[bwa_aln_core] refine gapped alignments... 0.23 sec
[bwa_aln_core] print alignments... 0.11 sec
[bwa_aln_core] 6029312 sequences have been processed.
[bwa_aln_core] convert to sequence coordinate... 1.25 sec
[bwa_aln_core] refine gapped alignments... 0.23 sec
[bwa_aln_core] print alignments... 0.13 sec
[bwa_aln_core] 6291456 sequences have been processed.
[bwa_aln_core] convert to sequence coordinate... 1.26 sec
[bwa_aln_core] refine gapped alignments... 0.23 sec
[bwa_aln_core] print alignments... 0.12 sec
[bwa_aln_core] 6553600 sequences have been processed.
[bwa_aln_core] convert to sequence coordinate... 1.28 sec
[bwa_aln_core] refine gapped alignments... 0.23 sec
[bwa_aln_core] print alignments... 0.12 sec
[bwa_aln_core] 6815744 sequences have been processed.
[bwa_aln_core] convert to sequence coordinate... 1.35 sec
[bwa_aln_core] refine gapped alignments... 0.24 sec
[bwa_aln_core] print alignments... 0.14 sec
[bwa_aln_core] 7077888 sequences have been processed.
[bwa_aln_core] convert to sequence coordinate... 1.35 sec
[bwa_aln_core] refine gapped alignments... 0.24 sec
[bwa_aln_core] print alignments... 0.15 sec
[bwa_aln_core] 7340032 sequences have been processed.
[bwa_aln_core] convert to sequence coordinate... 1.35 sec
[bwa_aln_core] refine gapped alignments... 0.24 sec
[bwa_aln_core] print alignments... 0.14 sec
[bwa_aln_core] 7602176 sequences have been processed.
[bwa_aln_core] convert to sequence coordinate... 1.36 sec
[bwa_aln_core] refine gapped alignments... 0.24 sec
[bwa_aln_core] print alignments... 0.14 sec
[bwa_aln_core] 7864320 sequences have been processed.
[bwa_aln_core] convert to sequence coordinate... 1.35 sec
[bwa_aln_core] refine gapped alignments... 0.24 sec
[bwa_aln_core] print alignments... 0.14 sec
[bwa_aln_core] 8126464 sequences have been processed.
[bwa_aln_core] convert to sequence coordinate... 1.34 sec
[bwa_aln_core] refine gapped alignments... 0.24 sec
[bwa_aln_core] print alignments... 0.14 sec
[bwa_aln_core] 8388608 sequences have been processed.
[bwa_aln_core] convert to sequence coordinate... 1.33 sec
[bwa_aln_core] refine gapped alignments... 0.24 sec
[bwa_aln_core] print alignments... 0.13 sec
[bwa_aln_core] 8650752 sequences have been processed.
[bwa_aln_core] convert to sequence coordinate... 1.33 sec
[bwa_aln_core] refine gapped alignments... 0.24 sec
[bwa_aln_core] print alignments... 0.13 sec
[bwa_aln_core] 8912896 sequences have been processed.
[bwa_aln_core] convert to sequence coordinate... 2.05 sec
[bwa_aln_core] refine gapped alignments... 0.27 sec
[bwa_aln_core] print alignments... 0.26 sec
[bwa_aln_core] 9175040 sequences have been processed.
[bwa_aln_core] convert to sequence coordinate... 2.43 sec
[bwa_aln_core] refine gapped alignments... 0.28 sec
[bwa_aln_core] print alignments... 0.32 sec
[bwa_aln_core] 9437184 sequences have been processed.
[bwa_aln_core] convert to sequence coordinate... 2.43 sec
[bwa_aln_core] refine gapped alignments... 0.28 sec
[bwa_aln_core] print alignments... 0.33 sec
[bwa_aln_core] 9699328 sequences have been processed.
[bwa_aln_core] convert to sequence coordinate... 2.42 sec
[bwa_aln_core] refine gapped alignments... 0.29 sec
[bwa_aln_core] print alignments... 0.32 sec
[bwa_aln_core] 9961472 sequences have been processed.
[bwa_aln_core] convert to sequence coordinate... 1.39 sec
[bwa_aln_core] refine gapped alignments... 0.21 sec
[bwa_aln_core] print alignments... 0.05 sec
[bwa_aln_core] 10000000 sequences have been processed.
[main] Version: 0.7.17-r1188
[main] CMD: bwa samse /global/home/users/jieruixu/jieruixu/sediment_dna/sedimix/reference_data/human/hg19.fa temp/stripped_simulation_s.sai data/stripped_simulation_s.fq.gz
[main] Real time: 83.594 sec; CPU: 81.884 sec
[bam_sort_core] merging from 2 files and 1 in-memory blocks...
[Mon Apr  8 10:13:28 2024]
Finished job 5.
1 of 9 steps (11%) done
Select jobs to execute...

[Mon Apr  8 10:13:28 2024]
rule mapping_quality_filter:
    input: mapping/stripped_simulation_s.bam
    output: mapping/stripped_simulation_s_L30MQ25.bam
    jobid: 4
    benchmark: benchmarks/mapping_quality_filter/stripped_simulation_s.txt
    reason: Missing output files: mapping/stripped_simulation_s_L30MQ25.bam; Input files updated by another job: mapping/stripped_simulation_s.bam
    wildcards: sample=stripped_simulation_s
    resources: tmpdir=/tmp

[Mon Apr  8 10:13:46 2024]
Finished job 4.
2 of 9 steps (22%) done
Select jobs to execute...

[Mon Apr  8 10:13:46 2024]
rule run_mapdamage:
    input: mapping/stripped_simulation_s_L30MQ25.bam, /global/home/users/jieruixu/jieruixu/sediment_dna/sedimix/reference_data/human/hg19.fa
    output: mapdamage_result/stripped_simulation_s
    jobid: 6
    benchmark: benchmarks/mapdamage/stripped_simulation_s.txt
    reason: Missing output files: mapdamage_result/stripped_simulation_s; Input files updated by another job: mapping/stripped_simulation_s_L30MQ25.bam
    wildcards: sample=stripped_simulation_s
    resources: tmpdir=/tmp

10:13:52 mapdamage.main INFO Started with the command: /global/home/users/jieruixu/.local/bin/mapDamage --merge-libraries -i mapping/stripped_simulation_s_L30MQ25.bam -r /global/home/users/jieruixu/jieruixu/sediment_dna/sedimix/reference_data/human/hg19.fa -d mapdamage_result/stripped_simulation_s
10:13:52 mapdamage.reader INFO Found 1 libraries in BAM file
10:13:52 mapdamage.main INFO Reading from 'mapping/stripped_simulation_s_L30MQ25.bam'
10:13:52 mapdamage.main INFO Writing results to 'mapdamage_result/stripped_simulation_s/'
10:14:39 mapdamage.rscript INFO Saving misincorporation plot to '/global/scratch/users/jieruixu/sediment_dna/sedimix/pipeline/SIM_Set3_centrifuge/mapdamage_result/stripped_simulation_s/Fragmisincorporation_plot.pdf'
10:14:39 mapdamage.rscript INFO Saving length distribution plot to '/global/scratch/users/jieruixu/sediment_dna/sedimix/pipeline/SIM_Set3_centrifuge/mapdamage_result/stripped_simulation_s/Length_plot.pdf'
10:14:44 mapdamage.rscript INFO Performing Bayesian estimates
10:14:46 mapdamage.rscript INFO Compiling C++ extension. This may take a moment ..
10:14:56 mapdamage.rscript INFO Compilation of C++ extension completed
10:14:56 mapdamage.rscript INFO Starting grid search, starting from random values
10:15:10 mapdamage.rscript INFO Adjusting the proposal variance iteration  1
10:15:34 mapdamage.rscript INFO Adjusting the proposal variance iteration  2
10:15:58 mapdamage.rscript INFO Adjusting the proposal variance iteration  3
10:16:22 mapdamage.rscript INFO Adjusting the proposal variance iteration  4
10:16:47 mapdamage.rscript INFO Adjusting the proposal variance iteration  5
10:17:11 mapdamage.rscript INFO Adjusting the proposal variance iteration  6
10:17:35 mapdamage.rscript INFO Adjusting the proposal variance iteration  7
10:17:59 mapdamage.rscript INFO Adjusting the proposal variance iteration  8
10:18:23 mapdamage.rscript INFO Adjusting the proposal variance iteration  9
10:18:47 mapdamage.rscript INFO Adjusting the proposal variance iteration  10
10:19:11 mapdamage.rscript INFO Done burning, starting the iterations
10:21:13 mapdamage.rscript INFO Done with the iterations, finishing up
10:21:13 mapdamage.rscript INFO Writing and plotting to files
10:21:55 mapdamage.main INFO Successful run
[Mon Apr  8 10:21:56 2024]
Finished job 6.
3 of 9 steps (33%) done
Select jobs to execute...

[Mon Apr  8 10:21:56 2024]
rule bam_to_fastq:
    input: mapping/stripped_simulation_s_L30MQ25.bam
    output: mapping/stripped_simulation_s_L30MQ25.fq
    jobid: 3
    benchmark: benchmarks/bam_to_fastq/stripped_simulation_s.txt
    reason: Missing output files: mapping/stripped_simulation_s_L30MQ25.fq; Input files updated by another job: mapping/stripped_simulation_s_L30MQ25.bam
    wildcards: sample=stripped_simulation_s
    resources: tmpdir=/tmp

[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 799996 reads
[Mon Apr  8 10:21:57 2024]
Finished job 3.
4 of 9 steps (44%) done
Select jobs to execute...

[Mon Apr  8 10:21:57 2024]
rule classification:
    input: mapping/stripped_simulation_s_L30MQ25.fq
    output: classification/stripped_simulation_s_L30MQ25.centrifuge, classification/stripped_simulation_s_L30MQ25.centrifugeLog, classification/stripped_simulation_s_L30MQ25.k2report
    jobid: 2
    benchmark: benchmarks/classification/stripped_simulation_s.txt
    reason: Missing output files: classification/stripped_simulation_s_L30MQ25.centrifuge; Input files updated by another job: mapping/stripped_simulation_s_L30MQ25.fq
    wildcards: sample=stripped_simulation_s
    resources: tmpdir=/tmp

Run Centrifuge Classification
Finish running centrifuge
Finish generating centrifuge report
[Mon Apr  8 10:22:30 2024]
Finished job 2.
5 of 9 steps (56%) done
Select jobs to execute...

[Mon Apr  8 10:22:30 2024]
rule generate_classified_reads:
    input: classification/stripped_simulation_s_L30MQ25.centrifuge, mapping/stripped_simulation_s_L30MQ25.fq
    output: final_reads/stripped_simulation_s_classified_homo_sapiens.fq, final_reads/stripped_simulation_s_reads.lst
    jobid: 1
    benchmark: benchmarks/generate_classified_reads/stripped_simulation_s.txt
    reason: Missing output files: final_reads/stripped_simulation_s_classified_homo_sapiens.fq, final_reads/stripped_simulation_s_reads.lst; Input files updated by another job: classification/stripped_simulation_s_L30MQ25.centrifuge, mapping/stripped_simulation_s_L30MQ25.fq
    wildcards: sample=stripped_simulation_s
    resources: tmpdir=/tmp

Number of total reads: 819516
Number of homo sapien reads classified: 783935
[Mon Apr  8 10:22:40 2024]
Finished job 1.
6 of 9 steps (67%) done
Select jobs to execute...

[Mon Apr  8 10:22:40 2024]
rule map_after_classification:
    input: final_reads/stripped_simulation_s_classified_homo_sapiens.fq
    output: mapping/stripped_simulation_s_classified_homo_sapiens.bam, mapping/stripped_simulation_s_classified_homo_sapiens.bam.bai, temp/stripped_simulation_s_classified_homo_sapiens.sai, temp/stripped_simulation_s_classified_homo_sapiens.sam
    jobid: 8
    benchmark: benchmarks/map_after_classification/stripped_simulation_s.txt
    reason: Missing output files: mapping/stripped_simulation_s_classified_homo_sapiens.bam; Input files updated by another job: final_reads/stripped_simulation_s_classified_homo_sapiens.fq
    wildcards: sample=stripped_simulation_s
    resources: tmpdir=/tmp

[bwa_aln] 17bp reads: max_diff = 2
[bwa_aln] 38bp reads: max_diff = 3
[bwa_aln] 64bp reads: max_diff = 4
[bwa_aln] 93bp reads: max_diff = 5
[bwa_aln] 124bp reads: max_diff = 6
[bwa_aln] 157bp reads: max_diff = 7
[bwa_aln] 190bp reads: max_diff = 8
[bwa_aln] 225bp reads: max_diff = 9
[bwa_aln_core] calculate SA coordinate... 18.26 sec
[bwa_aln_core] write to the disk... 0.03 sec
[bwa_aln_core] 262144 sequences have been processed.
[bwa_aln_core] calculate SA coordinate... 17.20 sec
[bwa_aln_core] write to the disk... 0.04 sec
[bwa_aln_core] 524288 sequences have been processed.
[bwa_aln_core] calculate SA coordinate... 28.79 sec
[bwa_aln_core] write to the disk... 0.04 sec
[bwa_aln_core] 784147 sequences have been processed.
[main] Version: 0.7.17-r1188
[main] CMD: bwa aln -t 8 /global/home/users/jieruixu/jieruixu/sediment_dna/sedimix/reference_data/human/hg19.fa final_reads/stripped_simulation_s_classified_homo_sapiens.fq
[main] Real time: 19.279 sec; CPU: 65.982 sec
[bwa_aln_core] convert to sequence coordinate... 2.37 sec
[bwa_aln_core] refine gapped alignments... 0.28 sec
[bwa_aln_core] print alignments... 0.33 sec
[bwa_aln_core] 262144 sequences have been processed.
[bwa_aln_core] convert to sequence coordinate... 2.39 sec
[bwa_aln_core] refine gapped alignments... 0.28 sec
[bwa_aln_core] print alignments... 0.31 sec
[bwa_aln_core] 524288 sequences have been processed.
[bwa_aln_core] convert to sequence coordinate... 2.35 sec
[bwa_aln_core] refine gapped alignments... 0.31 sec
[bwa_aln_core] print alignments... 0.35 sec
[bwa_aln_core] 784147 sequences have been processed.
[main] Version: 0.7.17-r1188
[main] CMD: bwa samse /global/home/users/jieruixu/jieruixu/sediment_dna/sedimix/reference_data/human/hg19.fa temp/stripped_simulation_s_classified_homo_sapiens.sai final_reads/stripped_simulation_s_classified_homo_sapiens.fq
[main] Real time: 9.721 sec; CPU: 9.445 sec
[Mon Apr  8 10:23:25 2024]
Finished job 8.
7 of 9 steps (78%) done
Select jobs to execute...

[Mon Apr  8 10:23:25 2024]
rule run_mapdamage_after_classification:
    input: mapping/stripped_simulation_s_classified_homo_sapiens.bam, /global/home/users/jieruixu/jieruixu/sediment_dna/sedimix/reference_data/human/hg19.fa
    output: mapdamage_result_after_classification/stripped_simulation_s
    jobid: 7
    benchmark: benchmarks/run_mapdamage_after_classification/stripped_simulation_s.txt
    reason: Missing output files: mapdamage_result_after_classification/stripped_simulation_s; Input files updated by another job: mapping/stripped_simulation_s_classified_homo_sapiens.bam
    wildcards: sample=stripped_simulation_s
    resources: tmpdir=/tmp

10:23:28 mapdamage.main INFO Started with the command: /global/home/users/jieruixu/.local/bin/mapDamage --merge-libraries -i mapping/stripped_simulation_s_classified_homo_sapiens.bam -r /global/home/users/jieruixu/jieruixu/sediment_dna/sedimix/reference_data/human/hg19.fa -d mapdamage_result_after_classification/stripped_simulation_s
10:23:28 mapdamage.reader INFO Found 1 libraries in BAM file
10:23:28 mapdamage.main INFO Reading from 'mapping/stripped_simulation_s_classified_homo_sapiens.bam'
10:23:28 mapdamage.main INFO Writing results to 'mapdamage_result_after_classification/stripped_simulation_s/'
10:24:14 mapdamage.rscript INFO Saving misincorporation plot to '/global/scratch/users/jieruixu/sediment_dna/sedimix/pipeline/SIM_Set3_centrifuge/mapdamage_result_after_classification/stripped_simulation_s/Fragmisincorporation_plot.pdf'
10:24:15 mapdamage.rscript INFO Saving length distribution plot to '/global/scratch/users/jieruixu/sediment_dna/sedimix/pipeline/SIM_Set3_centrifuge/mapdamage_result_after_classification/stripped_simulation_s/Length_plot.pdf'
10:24:21 mapdamage.rscript INFO Performing Bayesian estimates
10:24:23 mapdamage.rscript INFO Compiling C++ extension. This may take a moment ..
10:24:29 mapdamage.rscript INFO Compilation of C++ extension completed
10:24:29 mapdamage.rscript INFO Starting grid search, starting from random values
10:24:40 mapdamage.rscript INFO Adjusting the proposal variance iteration  1
10:25:05 mapdamage.rscript INFO Adjusting the proposal variance iteration  2
10:25:29 mapdamage.rscript INFO Adjusting the proposal variance iteration  3
10:25:53 mapdamage.rscript INFO Adjusting the proposal variance iteration  4
10:26:17 mapdamage.rscript INFO Adjusting the proposal variance iteration  5
10:26:41 mapdamage.rscript INFO Adjusting the proposal variance iteration  6
10:27:06 mapdamage.rscript INFO Adjusting the proposal variance iteration  7
10:27:30 mapdamage.rscript INFO Adjusting the proposal variance iteration  8
10:27:54 mapdamage.rscript INFO Adjusting the proposal variance iteration  9
10:28:18 mapdamage.rscript INFO Adjusting the proposal variance iteration  10
10:28:42 mapdamage.rscript INFO Done burning, starting the iterations
10:30:43 mapdamage.rscript INFO Done with the iterations, finishing up
10:30:43 mapdamage.rscript INFO Writing and plotting to files
10:31:26 mapdamage.main INFO Successful run
[Mon Apr  8 10:31:26 2024]
Finished job 7.
8 of 9 steps (89%) done
Select jobs to execute...

[Mon Apr  8 10:31:26 2024]
localrule all:
    input: final_reads/stripped_simulation_s_classified_homo_sapiens.fq, final_reads/stripped_simulation_s_reads.lst, mapdamage_result/stripped_simulation_s, mapdamage_result_after_classification/stripped_simulation_s
    jobid: 0
    reason: Input files updated by another job: final_reads/stripped_simulation_s_reads.lst, mapdamage_result/stripped_simulation_s, final_reads/stripped_simulation_s_classified_homo_sapiens.fq, mapdamage_result_after_classification/stripped_simulation_s
    resources: tmpdir=/tmp

[Mon Apr  8 10:31:26 2024]
Finished job 0.
9 of 9 steps (100%) done
Complete log: .snakemake/log/2024-04-08T095935.514196.snakemake.log
